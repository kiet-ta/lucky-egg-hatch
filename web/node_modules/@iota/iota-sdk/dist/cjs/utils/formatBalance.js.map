{
  "version": 3,
  "sources": ["../../../src/utils/formatBalance.ts"],
  "sourcesContent": ["// Copyright (c) Mysten Labs, Inc.\n// Modifications Copyright (c) 2024 IOTA Stiftung\n// SPDX-License-Identifier: Apache-2.0\n\nimport BigNumber from 'bignumber.js';\n\nfunction formatAmountParts(amount?: BigNumber | bigint | number | string | null): string[] {\n    if (typeof amount === 'undefined' || amount === null) {\n        return ['--'];\n    }\n\n    let postfix = '';\n    let bn = new BigNumber(amount.toString());\n    const bnAbs = bn.abs();\n\n    // use absolute value to determine the postfix\n    if (bnAbs.gte(1_000_000_000)) {\n        bn = bn.shiftedBy(-9);\n        postfix = 'B';\n    } else if (bnAbs.gte(1_000_000)) {\n        bn = bn.shiftedBy(-6);\n        postfix = 'M';\n    } else if (bnAbs.gte(10_000)) {\n        bn = bn.shiftedBy(-3);\n        postfix = 'K';\n    }\n\n    if (bnAbs.gte(1)) {\n        bn = bn.decimalPlaces(2, BigNumber.ROUND_DOWN);\n    }\n\n    if (bnAbs.gt(0) && bnAbs.lt(1)) {\n        const leadingZeros = countDecimalLeadingZeros(bn.toFormat());\n\n        if (leadingZeros >= 4) {\n            return [formatWithSubscript(bn.toFormat(), leadingZeros), postfix];\n        } else {\n            return [bn.toFormat(leadingZeros + 1), postfix];\n        }\n    }\n\n    return [bn.toFormat(), postfix];\n}\n\nexport function formatAmount(...args: Parameters<typeof formatAmountParts>) {\n    return formatAmountParts(...args)\n        .filter(Boolean)\n        .join(' ');\n}\n\nfunction countDecimalLeadingZeros(input: BigNumber | bigint | number | string | null): number {\n    if (input === null) {\n        return 0;\n    }\n\n    const [, decimals] = input.toString().split('.');\n\n    if (!decimals) {\n        return 0;\n    }\n\n    let count = 0;\n\n    for (const digit of decimals) {\n        if (digit === '0') {\n            count++;\n        } else {\n            break;\n        }\n    }\n\n    return count;\n}\n\nconst SUBSCRIPTS = ['\u2080', '\u2081', '\u2082', '\u2083', '\u2084', '\u2085', '\u2086', '\u2087', '\u2088', '\u2089'];\n\nexport function formatWithSubscript(\n    input: BigNumber | bigint | number | string | null,\n    zeroCount: number,\n): string {\n    if (input === null) {\n        return '0';\n    }\n\n    const [, decimals] = input.toString().split('.');\n    const remainder = decimals.slice(zeroCount);\n\n    const digits = zeroCount.toString().split('');\n    const subscripts = digits.map((n) => SUBSCRIPTS[Number(n)]).join('');\n\n    return `0.0${subscripts}${remainder}`;\n}\n\nexport enum CoinFormat {\n    Rounded = 'Rounded',\n    Full = 'Full',\n}\n\n/**\n * Formats a coin balance based on our standard coin display logic.\n * If the balance is less than 1, it will be displayed in its full decimal form.\n * For values greater than 1, it will be truncated to 3 decimal places.\n */\nexport function formatBalance(\n    balance: bigint | number | string,\n    decimals: number,\n    format: CoinFormat = CoinFormat.Rounded,\n    showSign = false,\n) {\n    const bn = new BigNumber(balance.toString()).shiftedBy(-1 * decimals);\n    let formattedBalance = formatAmount(bn);\n\n    if (format === CoinFormat.Full) {\n        formattedBalance = bn.toFormat();\n    }\n\n    if (showSign && !formattedBalance.startsWith('-')) {\n        formattedBalance = `+${formattedBalance}`;\n    }\n\n    return formattedBalance;\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,uBAAsB;AAEtB,SAAS,kBAAkB,QAAgE;AACvF,MAAI,OAAO,WAAW,eAAe,WAAW,MAAM;AAClD,WAAO,CAAC,IAAI;AAAA,EAChB;AAEA,MAAI,UAAU;AACd,MAAI,KAAK,IAAI,iBAAAA,QAAU,OAAO,SAAS,CAAC;AACxC,QAAM,QAAQ,GAAG,IAAI;AAGrB,MAAI,MAAM,IAAI,GAAa,GAAG;AAC1B,SAAK,GAAG,UAAU,EAAE;AACpB,cAAU;AAAA,EACd,WAAW,MAAM,IAAI,GAAS,GAAG;AAC7B,SAAK,GAAG,UAAU,EAAE;AACpB,cAAU;AAAA,EACd,WAAW,MAAM,IAAI,GAAM,GAAG;AAC1B,SAAK,GAAG,UAAU,EAAE;AACpB,cAAU;AAAA,EACd;AAEA,MAAI,MAAM,IAAI,CAAC,GAAG;AACd,SAAK,GAAG,cAAc,GAAG,iBAAAA,QAAU,UAAU;AAAA,EACjD;AAEA,MAAI,MAAM,GAAG,CAAC,KAAK,MAAM,GAAG,CAAC,GAAG;AAC5B,UAAM,eAAe,yBAAyB,GAAG,SAAS,CAAC;AAE3D,QAAI,gBAAgB,GAAG;AACnB,aAAO,CAAC,oBAAoB,GAAG,SAAS,GAAG,YAAY,GAAG,OAAO;AAAA,IACrE,OAAO;AACH,aAAO,CAAC,GAAG,SAAS,eAAe,CAAC,GAAG,OAAO;AAAA,IAClD;AAAA,EACJ;AAEA,SAAO,CAAC,GAAG,SAAS,GAAG,OAAO;AAClC;AAEO,SAAS,gBAAgB,MAA4C;AACxE,SAAO,kBAAkB,GAAG,IAAI,EAC3B,OAAO,OAAO,EACd,KAAK,GAAG;AACjB;AAEA,SAAS,yBAAyB,OAA4D;AAC1F,MAAI,UAAU,MAAM;AAChB,WAAO;AAAA,EACX;AAEA,QAAM,CAAC,EAAE,QAAQ,IAAI,MAAM,SAAS,EAAE,MAAM,GAAG;AAE/C,MAAI,CAAC,UAAU;AACX,WAAO;AAAA,EACX;AAEA,MAAI,QAAQ;AAEZ,aAAW,SAAS,UAAU;AAC1B,QAAI,UAAU,KAAK;AACf;AAAA,IACJ,OAAO;AACH;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AACX;AAEA,MAAM,aAAa,CAAC,UAAK,UAAK,UAAK,UAAK,UAAK,UAAK,UAAK,UAAK,UAAK,QAAG;AAE7D,SAAS,oBACZ,OACA,WACM;AACN,MAAI,UAAU,MAAM;AAChB,WAAO;AAAA,EACX;AAEA,QAAM,CAAC,EAAE,QAAQ,IAAI,MAAM,SAAS,EAAE,MAAM,GAAG;AAC/C,QAAM,YAAY,SAAS,MAAM,SAAS;AAE1C,QAAM,SAAS,UAAU,SAAS,EAAE,MAAM,EAAE;AAC5C,QAAM,aAAa,OAAO,IAAI,CAAC,MAAM,WAAW,OAAO,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE;AAEnE,SAAO,MAAM,UAAU,GAAG,SAAS;AACvC;AAEO,IAAK,aAAL,kBAAKC,gBAAL;AACH,EAAAA,YAAA,aAAU;AACV,EAAAA,YAAA,UAAO;AAFC,SAAAA;AAAA,GAAA;AAUL,SAAS,cACZ,SACA,UACA,SAAqB,yBACrB,WAAW,OACb;AACE,QAAM,KAAK,IAAI,iBAAAD,QAAU,QAAQ,SAAS,CAAC,EAAE,UAAU,KAAK,QAAQ;AACpE,MAAI,mBAAmB,aAAa,EAAE;AAEtC,MAAI,WAAW,mBAAiB;AAC5B,uBAAmB,GAAG,SAAS;AAAA,EACnC;AAEA,MAAI,YAAY,CAAC,iBAAiB,WAAW,GAAG,GAAG;AAC/C,uBAAmB,IAAI,gBAAgB;AAAA,EAC3C;AAEA,SAAO;AACX;",
  "names": ["BigNumber", "CoinFormat"]
}
